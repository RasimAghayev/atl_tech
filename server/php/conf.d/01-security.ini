; ===================================================
; PHP Security Configuration
; server/php/conf.d/01-security.ini
; ===================================================

; === INFORMATION DISCLOSURE ===
expose_php = Off
server_tokens = Off

; === DANGEROUS FUNCTIONS ===
; Təhlükəli funksiyaları söndür
disable_functions = exec,passthru,shell_exec,system,proc_open,popen,curl_exec,curl_multi_exec,parse_ini_file,show_source,highlight_file,ini_alter,ini_get_all,ini_restore,get_cfg_var,phpinfo,php_uname,phpversion

; === PATH SECURITY ===
cgi.fix_pathinfo = 0
doc_root = ""
user_dir = ""

; === FILE ACCESS ===
allow_url_fopen = Off
allow_url_include = Off
auto_prepend_file =
auto_append_file =

; === SESSION SECURITY ===
session.cookie_httponly = 1
session.cookie_secure = 1
session.use_strict_mode = 1
session.cookie_samesite = "Strict"
session.use_trans_sid = 0
session.entropy_length = 32
session.hash_function = sha256
session.hash_bits_per_character = 5

; === ERROR REPORTING (Security) ===
display_errors = Off
display_startup_errors = Off
error_reporting = E_ALL & ~E_NOTICE & ~E_WARNING
report_memleaks = Off
track_errors = Off

; === UPLOADS SECURITY ===
upload_tmp_dir = /tmp
max_file_uploads = 5

; === RESOURCE LIMITS (Security) ===
max_input_nesting_level = 64
max_input_vars = 2000
memory_limit = 256M
post_max_size = 32M
upload_max_filesize = 16M

; === MISC SECURITY ===
default_mimetype = "text/html"
default_charset = "UTF-8"

; === CGI SECURITY ===
cgi.force_redirect = 1
cgi.nph = 1
cgi.redirect_status_env = ""

; === MAIL SECURITY ===
mail.add_x_header = Off

; === SQL INJECTION PROTECTION ===
sql.safe_mode = Off

; === OPEN BASEDIR (Uncomment in production) ===
; open_basedir = /var/www/html:/tmp:/usr/share/pear

; === REGISTER GLOBALS ===
register_globals = Off
register_long_arrays = Off
register_argc_argv = Off

; === MAGIC QUOTES ===
magic_quotes_gpc = Off
magic_quotes_runtime = Off
magic_quotes_sybase = Off

; === ASSERT ===
assert.active = Off
assert.warning = Off
assert.bail = Off
assert.callback = ""

; === USER AGENT ===
user_agent = "SecurePHP/8.3"